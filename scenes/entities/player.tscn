[gd_scene load_steps=43 format=3 uid="uid://l4e1k3jkgu8s"]

[ext_resource type="Script" uid="uid://wgpmntr5gt2u" path="res://scenes/entities/player.gd" id="1_08t41"]
[ext_resource type="PackedScene" uid="uid://cvgcaefwbrg4n" path="res://art/characters/animations1.glb" id="1_ucweq"]
[ext_resource type="AnimationLibrary" uid="uid://d2yeay5avcx06" path="res://data/animations/animations.res" id="3_1ie0h"]
[ext_resource type="Script" uid="uid://b1aka3xixa22f" path="res://scripts/player/CameraOrbit.gd" id="4_42nxq"]
[ext_resource type="AudioStream" uid="uid://d2hewfgqv7n13" path="res://audio/sfx/player/jump.ogg" id="5_d4qa6"]
[ext_resource type="AudioStream" uid="uid://of70m6eteujd" path="res://audio/sfx/player/land.ogg" id="6_ss7kx"]
[ext_resource type="AudioStream" uid="uid://dassqoc4266pg" path="res://audio/sfx/footsteps/footstep.ogg" id="7_dnykm"]
[ext_resource type="Script" uid="uid://bxupbjreeq38q" path="res://scripts/player/Stamina.gd" id="8_c5rqy"]
[ext_resource type="Script" uid="uid://cnm5jyf244aty" path="res://Modules/Movement.gd" id="9_2floj"]
[ext_resource type="Script" uid="uid://l1fqubsbi2pf" path="res://Modules/Jump.gd" id="9_ck14j"]
[ext_resource type="Script" uid="uid://defc63lccppnx" path="res://Modules/State.gd" id="9_hd4nk"]
[ext_resource type="Script" uid="uid://d7166l6er61r" path="res://Modules/Orientation.gd" id="9_n5d2n"]
[ext_resource type="Script" uid="uid://buk7idb8jq37n" path="res://Modules/AnimationCtrl.gd" id="9_qq92a"]
[ext_resource type="Script" uid="uid://dnbmy77ibnv2s" path="res://Modules/AudioCtrl.gd" id="9_wa8qt"]
[ext_resource type="Script" uid="uid://dpr2epmd50orb" path="res://Modules/PerfectJumpCombo.gd" id="9_zq1h7"]
[ext_resource type="Script" uid="uid://0120b173f37a" path="res://scripts/player/PlayerInputHandler.gd" id="9_yf4ct"]
[ext_resource type="Script" uid="uid://91beeb5f7cc4" path="res://scripts/player/PlayerContextDetector.gd" id="9_zr6my"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ucweq"]

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_ogpgs"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yr3on"]
animation = &"front jump"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2ngu4"]
animation = &"fall air loop"

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_jv5ih"]
fadein_time = 0.05
fadeout_time = 0.35

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jv5ih"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_n36er"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_d745t"]
animation = &"run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_qc1tv"]
blend_point_0/node = SubResource("AnimationNodeAnimation_jv5ih")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_n36er")
blend_point_1/pos = 0.4
blend_point_2/node = SubResource("AnimationNodeAnimation_d745t")
blend_point_2/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_spk56"]

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_1yk18"]
sync = true
fadein_time = 0.25
fadeout_time = 0.32

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_b4o2o"]
fadein_time = 0.3
fadeout_time = 0.3

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_b4o2o"]
animation = &"sneak_exit"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qc1tv"]
animation = &"sneak_idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_xe83n"]
animation = &"sneak_idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_cwche"]
animation = &"sneakwalk"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_yv3je"]
blend_point_0/node = SubResource("AnimationNodeAnimation_qc1tv")
blend_point_0/pos = -1.0
blend_point_1/node = SubResource("AnimationNodeAnimation_xe83n")
blend_point_1/pos = 0.0
blend_point_2/node = SubResource("AnimationNodeAnimation_cwche")
blend_point_2/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_xe83n"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3hm5d"]
animation = &"sneak_enter"

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_cwche"]
graph_offset = Vector2(-805.383, -345.685)
nodes/AirBlend/node = SubResource("AnimationNodeBlend2_ogpgs")
nodes/AirBlend/position = Vector2(-20, -260)
nodes/Animation/node = SubResource("AnimationNodeAnimation_yr3on")
nodes/Animation/position = Vector2(-60, 80)
nodes/FallAnim/node = SubResource("AnimationNodeAnimation_2ngu4")
nodes/FallAnim/position = Vector2(-480, 20)
nodes/Jump/node = SubResource("AnimationNodeOneShot_jv5ih")
nodes/Jump/position = Vector2(140, -220)
nodes/Locomotion/node = SubResource("AnimationNodeBlendSpace1D_qc1tv")
nodes/Locomotion/position = Vector2(-1100, -480)
nodes/SneakBlend/node = SubResource("AnimationNodeBlend2_spk56")
nodes/SneakBlend/position = Vector2(-440, -540)
nodes/SneakEnter/node = SubResource("AnimationNodeOneShot_1yk18")
nodes/SneakEnter/position = Vector2(-640, -120)
nodes/SneakExit/node = SubResource("AnimationNodeOneShot_b4o2o")
nodes/SneakExit/position = Vector2(-240, -380)
nodes/SneakExitAnim/node = SubResource("AnimationNodeAnimation_b4o2o")
nodes/SneakExitAnim/position = Vector2(-400, -240)
nodes/SneakIdleWalk/node = SubResource("AnimationNodeBlendSpace1D_yv3je")
nodes/SneakIdleWalk/position = Vector2(-860, -120)
nodes/SprintSpeed/node = SubResource("AnimationNodeTimeScale_xe83n")
nodes/SprintSpeed/position = Vector2(-900, -460)
nodes/output/position = Vector2(380, -280)
nodes/sneak_enter/node = SubResource("AnimationNodeAnimation_3hm5d")
nodes/sneak_enter/position = Vector2(-840, 80)
node_connections = [&"AirBlend", 0, &"SneakExit", &"AirBlend", 1, &"FallAnim", &"Jump", 0, &"AirBlend", &"Jump", 1, &"Animation", &"SneakBlend", 0, &"SprintSpeed", &"SneakBlend", 1, &"SneakEnter", &"SneakEnter", 0, &"SneakIdleWalk", &"SneakEnter", 1, &"sneak_enter", &"SneakExit", 0, &"SneakBlend", &"SneakExit", 1, &"SneakExitAnim", &"SprintSpeed", 0, &"Locomotion", &"output", 0, &"Jump"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yv3je"]
advance_mode = 0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3hm5d"]
advance_mode = 0

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_y2dek"]
reset_ends = true
states/LocomotionSpeed/node = SubResource("AnimationNodeBlendTree_cwche")
states/LocomotionSpeed/position = Vector2(557, 112)
transitions = ["Start", "LocomotionSpeed", SubResource("AnimationNodeStateMachineTransition_yv3je"), "LocomotionSpeed", "End", SubResource("AnimationNodeStateMachineTransition_3hm5d")]
graph_offset = Vector2(-59, -120)

[sub_resource type="SphereShape3D" id="SphereShape3D_ogpgs"]

[sub_resource type="SphereShape3D" id="SphereShape3D_trigger"]
radius = 1.0

[node name="Player" type="CharacterBody3D" groups=["player"]]
collision_mask = 30
script = ExtResource("1_08t41")

[node name="PerfectJumpCombo" type="Node" parent="."]
script = ExtResource("9_zq1h7")

[node name="PlayerInputHandler" type="Node" parent="."]
script = ExtResource("9_yf4ct")

[node name="PlayerContextDetector" type="Node" parent="."]
script = ExtResource("9_zr6my")

[node name="Modules" type="Node" parent="."]

[node name="Movement" type="Node" parent="Modules"]
script = ExtResource("9_2floj")

[node name="Jump" type="Node" parent="Modules"]
script = ExtResource("9_ck14j")

[node name="State" type="Node" parent="Modules"]
script = ExtResource("9_hd4nk")

[node name="Orientation" type="Node" parent="Modules"]
script = ExtResource("9_n5d2n")

[node name="AnimationCtrl" type="Node" parent="Modules"]
script = ExtResource("9_qq92a")
animation_tree_path = NodePath("../../Pivot/Model/StateMachine")
state_module_path = NodePath("../State")

[node name="AudioCtrl" type="Node" parent="Modules"]
script = ExtResource("9_wa8qt")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.00319, 0)
shape = SubResource("CapsuleShape3D_ucweq")

[node name="Pivot" type="Node3D" parent="."]

[node name="Model" parent="Pivot" instance=ExtResource("1_ucweq")]

[node name="Skeleton3D" parent="Pivot/Model/Armature" index="0"]
bones/0/position = Vector3(2.22292, -0.241017, -77.185)
bones/0/rotation = Quaternion(-0.424714, -0.283687, 0.388349, 0.767023)
bones/1/rotation = Quaternion(0.132275, 0.0456412, -0.061616, 0.988243)
bones/2/rotation = Quaternion(0.126188, 0.0451106, -0.0514608, 0.989643)
bones/3/position = Vector3(0, 14.5212, 8.10623e-06)
bones/3/rotation = Quaternion(0.163155, -0.0238083, -0.080235, 0.983044)
bones/4/position = Vector3(-9.53674e-07, 16.3363, 6.32738e-06)
bones/4/rotation = Quaternion(-0.138341, 0.070682, 0.021615, 0.987623)
bones/5/position = Vector3(1.90735e-06, 10.8199, 1.1944)
bones/5/rotation = Quaternion(-0.305808, 0.278323, -0.0793679, 0.907039)
bones/7/position = Vector3(8.9036, 13.9265, -0.330393)
bones/7/rotation = Quaternion(-0.548279, -0.468789, 0.447949, -0.528176)
bones/8/position = Vector3(8.69872e-06, 18.5157, -5.34277e-06)
bones/8/rotation = Quaternion(-0.110518, -0.678255, 0.248961, 0.682477)
bones/9/position = Vector3(2.45816e-06, 35.3395, -3.75853e-07)
bones/9/rotation = Quaternion(0.015953, -0.0107998, 0.186517, 0.982263)
bones/10/position = Vector3(-5.23153e-06, 31.0194, -5.40946e-06)
bones/10/rotation = Quaternion(-0.157136, 0.245691, 0.1432, 0.945747)
bones/11/position = Vector3(-2.8989, 7.9915, -9.16532e-06)
bones/11/rotation = Quaternion(0.176338, 0.0888624, 0.161058, 0.96699)
bones/12/position = Vector3(-1.8988, 6.5303, 1.04873e-05)
bones/12/rotation = Quaternion(0.0348372, -0.00966279, -0.049652, 0.998112)
bones/13/position = Vector3(-0.589008, 6.8563, 1.04523e-05)
bones/13/rotation = Quaternion(-0.101998, -0.0101942, 0.0127406, 0.994651)
bones/14/position = Vector3(2.48779, 5.03, -7.41705e-06)
bones/15/position = Vector3(1.25905e-07, 9.92861, -3.24646e-06)
bones/15/rotation = Quaternion(-0.170941, 0.0908364, 0.0686376, 0.978681)
bones/16/position = Vector3(0.459699, 8.19772, -7.82917e-07)
bones/16/rotation = Quaternion(0.096482, 0.00242962, -0.0241612, 0.995039)
bones/17/position = Vector3(-0.175904, 8.29089, 1.45792e-05)
bones/17/rotation = Quaternion(-0.123296, -0.00800043, -0.0334798, 0.991773)
bones/18/position = Vector3(-0.283803, 5.48371, 1.55383e-05)
bones/19/position = Vector3(-8.9036, 13.9277, -0.339302)
bones/19/rotation = Quaternion(0.629207, -0.333037, 0.398749, 0.578087)
bones/20/position = Vector3(6.60468e-06, 18.5157, -1.91634e-06)
bones/20/rotation = Quaternion(0.454101, 0.264616, 0.255586, 0.811448)
bones/21/position = Vector3(4.68642e-06, 35.3422, 1.81587e-06)
bones/21/rotation = Quaternion(0.0318101, 0.010118, -0.350801, 0.935855)
bones/22/position = Vector3(-6.20658e-06, 31.0028, -2.23422e-06)
bones/22/rotation = Quaternion(-0.350372, 0.0213484, -0.220502, 0.910035)
bones/23/position = Vector3(2.68631, 8.3103, 2.83538e-06)
bones/23/rotation = Quaternion(0.131419, -0.153397, -0.109163, 0.973284)
bones/24/position = Vector3(2.2242, 6.6234, -1.90663e-06)
bones/24/rotation = Quaternion(0.0543184, 0.0289735, 0.129856, 0.98962)
bones/25/position = Vector3(0.501092, 6.8704, 1.5153e-05)
bones/25/rotation = Quaternion(-0.102778, -0.0196491, -0.156526, 0.982115)
bones/26/position = Vector3(-2.7253, 4.5916, -4.41074e-06)
bones/27/position = Vector3(7.38489e-06, 9.83319, -7.65513e-06)
bones/27/rotation = Quaternion(0.114266, -0.00213074, -0.0610256, 0.991572)
bones/28/position = Vector3(-0.356308, 7.7146, -5.11993e-06)
bones/28/rotation = Quaternion(0.106245, -0.00128113, 0.00887729, 0.9943)
bones/29/position = Vector3(0.100306, 8.2983, -6.15498e-08)
bones/29/rotation = Quaternion(-0.1154, 0.0055507, 0.0364678, 0.992634)
bones/30/position = Vector3(0.255999, 6.17799, 1.17648e-06)
bones/31/rotation = Quaternion(0.125786, 0.592086, 0.720826, -0.337671)
bones/32/position = Vector3(-1.37828e-06, 39.4052, -1.31868e-06)
bones/32/rotation = Quaternion(-0.269578, -0.0675039, -0.0329762, 0.960043)
bones/33/rotation = Quaternion(0.558902, -0.301169, 0.0865527, 0.767747)
bones/34/position = Vector3(1.25379e-06, 32.8951, -6.16882e-07)
bones/34/rotation = Quaternion(0.355657, -0.0210457, 0.00391906, 0.934371)
bones/35/position = Vector3(2.6077e-06, 11.7641, 1.81794e-06)
bones/36/rotation = Quaternion(0.0317765, 0.460722, 0.878729, 0.120665)
bones/37/rotation = Quaternion(-0.664723, 0.0557972, -0.0698128, 0.741725)
bones/38/rotation = Quaternion(0.781466, 0.128475, 0.0886592, 0.604107)
bones/39/position = Vector3(4.2183e-07, 33.3268, -2.4063e-06)
bones/39/rotation = Quaternion(0.413182, 0.0320555, -0.00212286, 0.910082)
bones/40/position = Vector3(5.21541e-07, 12.1799, -1.3411e-07)

[node name="AnimationPlayer" parent="Pivot/Model" index="1"]
libraries = {
&"": ExtResource("3_1ie0h")
}
autoplay = "idle"

[node name="StateMachine" type="AnimationTree" parent="Pivot/Model"]
tree_root = SubResource("AnimationNodeStateMachine_y2dek")
anim_player = NodePath("../AnimationPlayer")
parameters/LocomotionSpeed/AirBlend/blend_amount = 0
parameters/LocomotionSpeed/Jump/active = false
parameters/LocomotionSpeed/Jump/internal_active = false
parameters/LocomotionSpeed/Jump/request = 0
parameters/LocomotionSpeed/Locomotion/blend_position = 0
parameters/LocomotionSpeed/SneakBlend/blend_amount = 0.0
parameters/LocomotionSpeed/SneakEnter/active = false
parameters/LocomotionSpeed/SneakEnter/internal_active = false
parameters/LocomotionSpeed/SneakEnter/request = 0
parameters/LocomotionSpeed/SneakExit/active = false
parameters/LocomotionSpeed/SneakExit/internal_active = false
parameters/LocomotionSpeed/SneakExit/request = 0
parameters/LocomotionSpeed/SneakIdleWalk/blend_position = 0
parameters/LocomotionSpeed/SprintSpeed/scale = 1.0

[node name="CameraRig" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.6, 0)
script = ExtResource("4_42nxq")

[node name="Yaw" type="Node3D" parent="CameraRig"]

[node name="Pitch" type="Node3D" parent="CameraRig/Yaw"]

[node name="SpringArm3D" type="SpringArm3D" parent="CameraRig/Yaw/Pitch"]
shape = SubResource("SphereShape3D_ogpgs")
spring_length = 5.0
margin = 0.2

[node name="Camera3D" type="Camera3D" parent="CameraRig/Yaw/Pitch/SpringArm3D"]
current = true

[node name="JumpSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("5_d4qa6")
unit_size = 1.0
max_distance = 10.0

[node name="LandSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("6_ss7kx")
volume_db = 10.0
unit_size = 1.0
max_distance = 10.0

[node name="FootstepSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("7_dnykm")
volume_db = -5.036

[node name="TriggerArea" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 1048575
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="TriggerArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("SphereShape3D_trigger")

[node name="Stamina" type="Node" parent="."]
script = ExtResource("8_c5rqy")

[editable path="Pivot/Model"]
