[gd_scene load_steps=55 format=3 uid="uid://l4e1k3jkgu8s"]

[ext_resource type="Script" uid="uid://wgpmntr5gt2u" path="res://scenes/entities/player.gd" id="1_08t41"]
[ext_resource type="PackedScene" uid="uid://cvgcaefwbrg4n" path="res://art/characters/animations1.glb" id="1_ucweq"]
[ext_resource type="AnimationLibrary" uid="uid://d2yeay5avcx06" path="res://data/animations/animations.res" id="3_1ie0h"]
[ext_resource type="Script" uid="uid://b1aka3xixa22f" path="res://scripts/player/CameraOrbit.gd" id="4_42nxq"]
[ext_resource type="AudioStream" uid="uid://d2hewfgqv7n13" path="res://audio/sfx/player/jump.ogg" id="5_d4qa6"]
[ext_resource type="AudioStream" uid="uid://of70m6eteujd" path="res://audio/sfx/player/land.ogg" id="6_ss7kx"]
[ext_resource type="AudioStream" uid="uid://dassqoc4266pg" path="res://audio/sfx/footsteps/footstep.ogg" id="7_dnykm"]
[ext_resource type="Script" uid="uid://bxupbjreeq38q" path="res://scripts/player/Stamina.gd" id="8_c5rqy"]
[ext_resource type="Script" uid="uid://cnm5jyf244aty" path="res://Modules/Movement.gd" id="9_2floj"]
[ext_resource type="Script" uid="uid://l1fqubsbi2pf" path="res://Modules/Jump.gd" id="9_ck14j"]
[ext_resource type="Script" uid="uid://defc63lccppnx" path="res://Modules/State.gd" id="9_hd4nk"]
[ext_resource type="Script" uid="uid://d7166l6er61r" path="res://Modules/Orientation.gd" id="9_n5d2n"]
[ext_resource type="Script" uid="uid://buk7idb8jq37n" path="res://Modules/AnimationCtrl.gd" id="9_qq92a"]
[ext_resource type="Script" uid="uid://dnbmy77ibnv2s" path="res://Modules/AudioCtrl.gd" id="9_wa8qt"]
[ext_resource type="Script" uid="uid://dpr2epmd50orb" path="res://Modules/PerfectJumpCombo.gd" id="9_zq1h7"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ucweq"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yr3on"]
animation = &"fall air loop"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2ngu4"]
animation = &"jump"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_jv5ih"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_n36er"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_d745t"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qc1tv"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_xe83n"]
animation = &"run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_cwche"]
blend_point_0/node = SubResource("AnimationNodeAnimation_jv5ih")
blend_point_0/pos = -1.0
blend_point_1/node = SubResource("AnimationNodeAnimation_n36er")
blend_point_1/pos = 1.0
blend_point_2/node = SubResource("AnimationNodeAnimation_d745t")
blend_point_2/pos = 0.0
blend_point_3/node = SubResource("AnimationNodeAnimation_qc1tv")
blend_point_3/pos = 0.4
blend_point_4/node = SubResource("AnimationNodeAnimation_xe83n")
blend_point_4/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yv3je"]
xfade_time = 0.12
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3hm5d"]
xfade_time = 0.18
advance_mode = 0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yw3xw"]
xfade_time = 0.1
advance_mode = 0

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_u2s01"]
xfade_time = 0.18
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tb0mf"]
xfade_time = 0.25
advance_mode = 0

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_y2dek"]
reset_ends = true
states/FallAnim/node = SubResource("AnimationNodeAnimation_yr3on")
states/FallAnim/position = Vector2(508, 217)
states/Jump/node = SubResource("AnimationNodeAnimation_2ngu4")
states/Jump/position = Vector2(349, 217)
states/Locomotion/node = SubResource("AnimationNodeBlendSpace1D_cwche")
states/Locomotion/position = Vector2(412, 34)
transitions = ["Start", "Locomotion", SubResource("AnimationNodeStateMachineTransition_yv3je"), "Locomotion", "End", SubResource("AnimationNodeStateMachineTransition_3hm5d"), "Locomotion", "Jump", SubResource("AnimationNodeStateMachineTransition_yw3xw"), "Jump", "FallAnim", SubResource("AnimationNodeStateMachineTransition_u2s01"), "FallAnim", "Locomotion", SubResource("AnimationNodeStateMachineTransition_tb0mf")]
graph_offset = Vector2(-92, -62)

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_1ie0h"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1ie0h"]
animation = &"front jump"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_42nxq"]
animation = &"fall air loop"

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_42nxq"]
fadein_time = 0.05
fadeout_time = 0.35

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5u6hq"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_d4qa6"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ss7kx"]
animation = &"run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_dnykm"]
blend_point_0/node = SubResource("AnimationNodeAnimation_5u6hq")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_d4qa6")
blend_point_1/pos = 0.4
blend_point_2/node = SubResource("AnimationNodeAnimation_ss7kx")
blend_point_2/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_1ie0h"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ogpgs"]
animation = &"sneak_enter"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_spk56"]
animation = &"sneak_exit"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_b4o2o"]
animation = &"sneak_idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1yk18"]
animation = &"sneakwalk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_b4o2o"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yr3on"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2ngu4"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_jv5ih"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_n36er"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_d745t"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qc1tv"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xe83n"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_ogpgs"]
states/Start/position = Vector2(241, 100)
states/sneak_enter/node = SubResource("AnimationNodeAnimation_ogpgs")
states/sneak_enter/position = Vector2(378, 4)
states/sneak_exit/node = SubResource("AnimationNodeAnimation_spk56")
states/sneak_exit/position = Vector2(733, 57)
states/sneak_idle/node = SubResource("AnimationNodeAnimation_b4o2o")
states/sneak_idle/position = Vector2(501, 92)
states/sneakwalk/node = SubResource("AnimationNodeAnimation_1yk18")
states/sneakwalk/position = Vector2(567, 20)
transitions = ["Start", "sneak_enter", SubResource("AnimationNodeStateMachineTransition_b4o2o"), "sneak_enter", "sneakwalk", SubResource("AnimationNodeStateMachineTransition_yr3on"), "sneakwalk", "sneak_exit", SubResource("AnimationNodeStateMachineTransition_2ngu4"), "sneak_exit", "End", SubResource("AnimationNodeStateMachineTransition_jv5ih"), "sneak_enter", "sneak_idle", SubResource("AnimationNodeStateMachineTransition_n36er"), "sneak_idle", "sneakwalk", SubResource("AnimationNodeStateMachineTransition_d745t"), "sneakwalk", "sneak_idle", SubResource("AnimationNodeStateMachineTransition_qc1tv"), "sneak_idle", "sneak_exit", SubResource("AnimationNodeStateMachineTransition_xe83n")]
graph_offset = Vector2(-142, -105)

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_c5rqy"]
graph_offset = Vector2(-325.639, 332.75)
nodes/AirBlend/node = SubResource("AnimationNodeBlend2_1ie0h")
nodes/AirBlend/position = Vector2(380, 820)
nodes/Animation/node = SubResource("AnimationNodeAnimation_1ie0h")
nodes/Animation/position = Vector2(-20, 420)
nodes/FallAnim/node = SubResource("AnimationNodeAnimation_42nxq")
nodes/FallAnim/position = Vector2(100, 1000)
nodes/Jump/node = SubResource("AnimationNodeOneShot_42nxq")
nodes/Jump/position = Vector2(640, 600)
nodes/Locomotion/node = SubResource("AnimationNodeBlendSpace1D_dnykm")
nodes/Locomotion/position = Vector2(-460, 880)
nodes/SprintScale/node = SubResource("AnimationNodeTimeScale_1ie0h")
nodes/SprintScale/position = Vector2(180, 660)
nodes/output/position = Vector2(1480, 700)
nodes/sneak/node = SubResource("AnimationNodeStateMachine_ogpgs")
nodes/sneak/position = Vector2(880, 820)
node_connections = [&"AirBlend", 0, &"SprintScale", &"AirBlend", 1, &"FallAnim", &"Jump", 0, &"AirBlend", &"Jump", 1, &"Animation", &"SprintScale", 0, &"Locomotion", &"output", 0, &"Jump"]

[sub_resource type="SphereShape3D" id="SphereShape3D_ogpgs"]

[node name="Player" type="CharacterBody3D" groups=["player"]]
collision_mask = 30
script = ExtResource("1_08t41")

[node name="PerfectJumpCombo" type="Node" parent="."]
script = ExtResource("9_zq1h7")

[node name="Modules" type="Node" parent="."]

[node name="Movement" type="Node" parent="Modules"]
script = ExtResource("9_2floj")

[node name="Jump" type="Node" parent="Modules"]
script = ExtResource("9_ck14j")

[node name="State" type="Node" parent="Modules"]
script = ExtResource("9_hd4nk")

[node name="Orientation" type="Node" parent="Modules"]
script = ExtResource("9_n5d2n")

[node name="AnimationCtrl" type="Node" parent="Modules"]
script = ExtResource("9_qq92a")
animation_tree_path = NodePath("../../Pivot/Model/StateMachine")
state_module_path = NodePath("../State")

[node name="AudioCtrl" type="Node" parent="Modules"]
script = ExtResource("9_wa8qt")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.00319, 0)
shape = SubResource("CapsuleShape3D_ucweq")

[node name="Pivot" type="Node3D" parent="."]

[node name="Model" parent="Pivot" instance=ExtResource("1_ucweq")]

[node name="Skeleton3D" parent="Pivot/Model/Armature" index="0"]
bones/0/position = Vector3(-0.581112, 0.454045, -98.6839)
bones/0/rotation = Quaternion(-0.730647, -0.0503243, 0.0142751, 0.680749)
bones/1/rotation = Quaternion(-0.032279, 0.0146266, 0.0258774, 0.999037)
bones/2/rotation = Quaternion(0.0120417, 0.00210048, 0.0150723, 0.999812)
bones/3/position = Vector3(1.78814e-07, 14.5212, 3.1665e-07)
bones/3/rotation = Quaternion(0.0118215, 0.00229528, 0.0151087, 0.999813)
bones/4/position = Vector3(-1.19209e-06, 16.3363, -1.56343e-06)
bones/4/rotation = Quaternion(0.122797, -0.00248844, 0.00374021, 0.992422)
bones/5/position = Vector3(1.16229e-06, 10.82, 1.19436)
bones/5/rotation = Quaternion(-0.0747018, 0.00706176, 0.000705865, 0.997181)
bones/7/position = Vector3(8.90357, 13.9265, -0.330399)
bones/7/rotation = Quaternion(-0.661664, -0.343495, 0.501372, -0.439133)
bones/8/position = Vector3(1.17719e-06, 18.5157, -6.57739e-06)
bones/8/rotation = Quaternion(0.512926, 0.157095, 0.0684918, 0.841152)
bones/9/position = Vector3(-3.57147e-06, 35.3395, -1.07962e-06)
bones/9/rotation = Quaternion(0.00119604, -0.0114342, 0.0139799, 0.999836)
bones/10/position = Vector3(-3.39048e-06, 31.0194, 9.26468e-08)
bones/10/rotation = Quaternion(0.0396306, -0.134098, 0.0278202, 0.989784)
bones/11/position = Vector3(-2.89887, 7.99146, -5.96046e-06)
bones/11/rotation = Quaternion(0.128632, 0.0518774, 0.126902, 0.98217)
bones/12/position = Vector3(-1.89883, 6.53035, -2.88479e-06)
bones/12/rotation = Quaternion(-0.048527, 0.0743475, -0.180537, 0.979553)
bones/13/position = Vector3(-0.58896, 6.8563, 2.29906e-06)
bones/13/rotation = Quaternion(-0.131973, -0.0497106, 0.240476, 0.960356)
bones/14/position = Vector3(2.48781, 5.02997, -1.53279e-07)
bones/14/rotation = Quaternion(0.0329957, 0.0676644, -0.00559058, 0.997147)
bones/15/position = Vector3(-5.49848e-06, 9.92859, -3.71691e-06)
bones/15/rotation = Quaternion(0.0626526, 0.00783366, 0.0515708, 0.996671)
bones/16/position = Vector3(0.459713, 8.19776, 6.69072e-08)
bones/16/rotation = Quaternion(0.150201, 0.00146643, -0.0159519, 0.988526)
bones/17/position = Vector3(-0.175882, 8.29094, -2.56183e-06)
bones/17/rotation = Quaternion(0.0697658, -0.000977527, -0.00485384, 0.997551)
bones/18/position = Vector3(-0.283827, 5.48367, 1.87445e-06)
bones/18/rotation = Quaternion(-0.00240551, 0.0375559, -0.0122402, 0.999217)
bones/19/position = Vector3(-8.90358, 13.9277, -0.339307)
bones/19/rotation = Quaternion(0.660085, -0.34484, 0.519199, 0.419292)
bones/20/position = Vector3(1.64932e-06, 18.5157, -3.56786e-07)
bones/20/rotation = Quaternion(0.443931, -0.245215, -0.087937, 0.857358)
bones/21/position = Vector3(-5.26337e-07, 35.3422, 2.30281e-07)
bones/21/rotation = Quaternion(0.00527027, 0.0126254, -0.0581134, 0.998216)
bones/22/position = Vector3(-2.97778e-06, 31.0028, 5.97858e-07)
bones/22/rotation = Quaternion(0.0532894, -0.00874433, -0.00510528, 0.998528)
bones/23/position = Vector3(2.68634, 8.31027, -4.29152e-06)
bones/23/rotation = Quaternion(0.116311, -0.0412915, -0.130633, 0.983718)
bones/24/position = Vector3(2.22424, 6.62345, 5.26976e-07)
bones/24/rotation = Quaternion(-0.0236724, -0.0701282, 0.189818, 0.979026)
bones/25/position = Vector3(0.501069, 6.87045, -6.03747e-06)
bones/25/rotation = Quaternion(-0.163821, 0.0346952, -0.25217, 0.953084)
bones/26/position = Vector3(-2.72531, 4.59165, -2.4394e-06)
bones/26/rotation = Quaternion(0.0481684, -0.0828008, 0.00872715, 0.995363)
bones/27/position = Vector3(-1.73003e-06, 9.83324, -1.13271e-05)
bones/27/rotation = Quaternion(0.0544006, 0.0037142, -0.049363, 0.997291)
bones/28/position = Vector3(-0.356317, 7.71457, -5.28002e-06)
bones/28/rotation = Quaternion(0.149178, -0.000531879, 0.000597338, 0.98881)
bones/29/position = Vector3(0.100351, 8.29832, -4.88058e-06)
bones/29/rotation = Quaternion(0.0692561, 0.000620955, 0.00149976, 0.997598)
bones/30/position = Vector3(0.255966, 6.17802, 8.08378e-06)
bones/30/rotation = Quaternion(-0.002614, -0.0483103, 0.0126288, 0.998749)
bones/31/rotation = Quaternion(0.133555, 0.0807148, 0.982029, -0.106145)
bones/32/position = Vector3(3.08992e-06, 39.4052, 3.50303e-06)
bones/32/rotation = Quaternion(-0.177067, -0.015763, -0.0090214, 0.984031)
bones/33/rotation = Quaternion(0.473693, -0.0931757, 0.0146658, 0.875624)
bones/34/rotation = Quaternion(0.362133, -0.0223702, 0.00373067, 0.93185)
bones/36/position = Vector3(-11.1802, -5.99402, -0.108211)
bones/36/rotation = Quaternion(-0.0867517, -0.016451, 0.996094, 0.000298165)
bones/37/position = Vector3(8.61697e-07, 39.4311, -7.96787e-07)
bones/37/rotation = Quaternion(-0.12643, 0.0877291, 0.0267506, 0.987726)
bones/38/position = Vector3(-7.53924e-07, 34.1215, -1.54662e-06)
bones/38/rotation = Quaternion(0.525309, 0.0815457, -0.0584566, 0.844976)
bones/39/position = Vector3(8.41342e-07, 33.3266, -2.69441e-06)
bones/39/rotation = Quaternion(0.375318, 0.0244236, -0.00302931, 0.926569)
bones/40/position = Vector3(-2.35438e-06, 12.1798, -6.55651e-07)

[node name="AnimationPlayer" parent="Pivot/Model" index="1"]
libraries = {
&"": ExtResource("3_1ie0h")
}
autoplay = "idle"

[node name="StateMachine" type="AnimationTree" parent="Pivot/Model"]
tree_root = SubResource("AnimationNodeStateMachine_y2dek")
anim_player = NodePath("../AnimationPlayer")
parameters/Locomotion/blend_position = -0.995142

[node name="AnimationTree2" type="AnimationTree" parent="Pivot/Model"]
reset_on_save = false
tree_root = SubResource("AnimationNodeBlendTree_c5rqy")
advance_expression_base_node = NodePath("")
parameters/AirBlend/blend_amount = 0.0
parameters/Jump/active = false
parameters/Jump/internal_active = 0.9
parameters/Jump/request = 0
parameters/Locomotion/blend_position = 0.531984
parameters/SprintScale/scale = 0.006901

[node name="CameraRig" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.6, 0)
script = ExtResource("4_42nxq")

[node name="Yaw" type="Node3D" parent="CameraRig"]

[node name="Pitch" type="Node3D" parent="CameraRig/Yaw"]

[node name="SpringArm3D" type="SpringArm3D" parent="CameraRig/Yaw/Pitch"]
shape = SubResource("SphereShape3D_ogpgs")
spring_length = 5.0
margin = 0.2

[node name="Camera3D" type="Camera3D" parent="CameraRig/Yaw/Pitch/SpringArm3D"]
current = true

[node name="JumpSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("5_d4qa6")
unit_size = 1.0
max_distance = 10.0

[node name="LandSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("6_ss7kx")
unit_size = 1.0
max_distance = 10.0

[node name="FootstepSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("7_dnykm")
volume_db = -25.289

[node name="Stamina" type="Node" parent="."]
script = ExtResource("8_c5rqy")

[editable path="Pivot/Model"]
